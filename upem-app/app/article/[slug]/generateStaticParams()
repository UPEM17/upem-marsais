// upem-app/app/article/[slug]/page.tsx
import Link from "next/link";
import { getAllSlugs, getArticleBySlug } from "@/lib/content";

export const dynamic = "error"; // on force le statique
export const revalidate = false;

export async function generateStaticParams() {
  const slugs = getAllSlugs();
  return slugs.map(slug => ({ slug }));
}

type Props = { params: { slug: string } };

export default function ArticlePage({ params }: Props) {
  const article = getArticleBySlug(params.slug);

  if (!article) {
    return (
      <main className="container">
        <h1>Article introuvable</h1>
        <p><Link href="/">Retour</Link></p>
      </main>
    );
  }

  return (
    <main className="container">
      <p><Link href="/">← Retour</Link></p>
      <h1>{article.title}</h1>
      <p><em>{new Date(article.date).toLocaleDateString("fr-FR")}</em></p>
      {article.image && (
        // utilise simplement <img>, pas next/image pour l’export
        <p><img src={article.image} alt="" style={{maxWidth:"100%"}} /></p>
      )}
      <article dangerouslySetInnerHTML={{ __html: article.body || "" }} />
    </main>
  );
}
